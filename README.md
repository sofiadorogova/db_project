# **_Проект по курсу "Базы данных"_**

## _Описание проекта_

### _Тема:_ 

База данных для медицинских учреждений для учета приемов, оплаты услуг и их проведения.

### _Мотивация:_

Учет проведения медицинских услуг, их стоимости, качества диагностирования и лицензирования врачей, важны для поддержания эффективности работы медицинских учреждений. Мною предложена база данных для одного из таких учреждений. 

### _Описание:_
---
 
Здесь будет информация о сущностях проекта.

Информация о каждой сущности разделена мною на блоки, поскольку с каждой из них будут связаны небольшие побочные таблицы, созданные для оптимизация запросов и хранения информации.


#### Блок 1 (пациенты): 

Есть 2 таблицы относящиеся к информации о пациентах. 

`patients`  
В таблице перечислены ID пациентов, пол, день рождения и контактная информация (номер телефона).  

`patients_names` 
Таблица связана с `patients` по ID пациента и хранит фимилии и имена пациентов. Используем для оптимизации хранения длинных строковых данных.

#### Блок 2 (врачи):

Используем две таблицы для сущности - врачи.

`doctors`  
Хранит ID докторов больницы, их специализации, номера лицензий и часы работы. 

`doctor_names`  
Аналогично таблице с именами пациентов, храним в этой таблице имена и фамилии врачей. 

#### Блок 3 (медицинские записи):

`medical_records`  
Основная таблица, содержащая информацию о поставленных диагнозах и результатах обследований (атрибуты - ID записи, врача, пациента и результата анализов, дата записи, код диагноза). Так как записи делаются вручную врачами, то во избежание ошибки строковые данные (результаты анализов и диагнозы) выносим в отдельные две таблицы перечисленные ниже.

`lab_results`
Для оптимальности хранения строковых данных заводим отдельную таблицу с индексами результатов анализов и их названиями.

`diagnoses`    
Для оптимальность хранения строковых данных заводим отдельную таблицу с индексами диагнозов и их названиями.


#### Блок 4 (назначения):

`prescriptions`  
Содержит информацию о выписанных пациентам медикаментах, дозе и длительности применения. Каждое назначение связано с отдельной медицинской записью, поэтому атрибутами будут - ID назначения, ID медицинской записи, медикамент, доза, срок применения.


#### Блок 5 (приемы):

`appointments`  
Содержит информацию о дате и времени приема, враче и пациенте (храняться только ID).

#### Блок 6 (счета):

`invoice`  
Содержит информацию о проведенных услугах, пациентах и статусе оплаты. В атрибутах храним: ID чека (уникальные), ID пациента,ID оказанной услуги, метод оплаты, статус. К данной таблице будет применятся версионирование, т.к. хотим хранить данные о статусе оплаты и времени, когда она была произведена. Тип версионирования SCD2, поскольку данные по каждому чеку редко меняются более 2х раз (смена статуса оплаты).

`price_list`  
Храним в этой таблице цены на каждый тип услуг. Используемые атрибуты: ID услуги, стоимость услуги по страховке, стоимость улуги без страховки (в тысячах).

#### Блок 7 (страховки):

`insurances`  
В таблице перечислены номера всех страховых полисов и ID привязанных к ним пациентов, также здесь хранится информация о сроках действия страховки и о сумме, которую покрывает страховка. Для этой таблице предусмотрена возможность версионирования, поскольку данные по каждой страховке могут менятся (оставшаяся сумма или продление срока действия). Так как мы храним важную для пациента историческую информацию, будем использовать SCD4 версионирование. 

`history_insurances`  
Хранит исторические данные из таблицы `insurances`, по каждому страховому полису. 


---

## _Проектирование_ 
### Концептуальная модель

![https://gitlab.atp-fivt.org/db2024s/dorogovaso-project/-/raw/main/pictures/logical_scheme.png](https://github.com/sofiadorogova/db_project/blob/dev/concept_scheme.png)


### Логическая модель

Обозначения(цвет таблиц): фиолетовый - основные сущности, голубой - вспомогательные таблицы (нормализация базы данных), розовый - таблица для поддержания SCD4 версионирования.

![https://gitlab.atp-fivt.org/db2024s/dorogovaso-project/-/raw/main/pictures/concept_scheme.png?ref=main](https://github.com/sofiadorogova/db_project/raw/dev/logical_scheme.png
)

### Физическая модель

В данной работе будет использоваться СУБД `PostgreSQL`. Физическая модель сконструирована, исходя из функционала выбранной СУБД. 

![https://gitlab.atp-fivt.org/db2024s/dorogovaso-project/-/raw/main/pictures/physical_scheme.png](https://github.com/sofiadorogova/db_project/blob/dev/physical_scheme.png)


## _Создание и заполнение_ 

Для создания базы данных используют `DDL` запросы (Data Definition Language). С помощью `create` запросов мы прописываем отношения и их связи в базе данных. [Здесь приведена реализация `create` запросов согласно построенной модели](https://gitlab.atp-fivt.org/db2024s/dorogovaso-project/-/raw/main/scripts/create.sql).

Заполнение производится засчет `insert` запросов (Data Manipulation Language), которые прописаны для данной базы данных [здесь](https://gitlab.atp-fivt.org/db2024s/dorogovaso-project/-/raw/main/scripts/insertions.sql?ref_type=heads).

## _Select запросы_

[Код представлен здесь.](https://gitlab.atp-fivt.org/db2024s/dorogovaso-project/-/raw/main/scripts/select.sql?ref_type=heads)


